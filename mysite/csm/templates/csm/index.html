{% extends 'base.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<link rel="stylesheet" href="{% static 'css/csm.css' %}">
<link rel="stylesheet" href="{% static 'css/loading.css' %}">
{% if user.is_authenticated %} 
    <h3 class="menuTitle">å…¨è¯ Monthly <B>{{month}}æœˆ</B></h3>
    <div data-preset="energy" class="ldBar label-center" data-value="35"></div>
    <form method="GET">
        <div class="searchForm">
            <input type="month" name="input-month" id="monthSearch" class="searchMonth">
            <select name="input-prd" id="selectSearch" class="select" onChange="selectedPrd()">
                <option value="" selected> ALL </option>
                <option value="11530035"> æ´»è”˜28D </option>
                <option value="11060162"> è”˜ç²¾ETç§˜ </option>
                <option value="17010087"> æ´»è”˜28D/è”˜æ´»åŠ›é£²ç¦®ç›’ </option>
                <option value="17010088"> è”˜çŸ³æ¦´é£² </option>
                <option value="17010004"> è”˜é‡æ«»è“é£² </option>
                <option value="17010002"> è”˜ç²¾ETç¦®ç›’ </option>
                <option value="12345678"> test </option>
            </select> 
            <input type="submit" id="btnSearch" value="ğŸ”ï¸">
        </div>
    </form>
    <p id="pInfo"><B>* æ¯æ—¥éŠ·è²¨ç¸½è¨ˆ</B>: éŠ·è²¨é‡/ç•¶æœˆç¸½å¤©æ•¸, <B>èª¤å·®å€¼</B>: éŠ·è²¨é‡/æ¯æ—¥éŠ·è²¨ç¸½è¨ˆ, <B>åº«å­˜æœˆä»½</B>: åº«å­˜é‡/éŠ·è²¨é‡</p>
    <div class="dataGrid">
        <table class="tableGrid" id="myTable">
            <thead>
                <tr id="thTr">
                    <th><B>å€åŸŸ</B></th>
                    <th><B>ç¸£å¸‚</B></th>
                    <th><B>é–€å¸‚ä»£è™Ÿ</B></th>
                    <th><B>é–€å¸‚åç¨±</B><span id="prdName" name="prdName" value="â–²"></span></th>
                    <th><B>ä»£è™Ÿ</B></th>
                    <th><B>æ¢ç¢¼</B></th>
                    <th><B>å“å/è¦æ ¼</B></th>
                    <th><B>ä¸Šå­˜é‡</B><span id="prdSave" name="prdSave">â–²â–¼</span></th>
                    <th><B>é€²è²¨é‡</B><span id="prdBuy" name="prdBuy">â–²â–¼</span></th>
                    <th><B>é€€è²¨é‡</B><span id="prdReturn" name="prdReturn">â–²â–¼</span></th>
                    <th><B>éŠ·è²¨é‡</B><span id="prdSale" name="prdSale">â–²â–¼</span></th>
                    <th><B>æ¯æ—¥éŠ·è²¨ç¸½è¨ˆ</B></th>
                    <th><B>èª¤å·®å€¼(%)</B></th>
                    <th><B>åº«å­˜é‡</B><span id="prdStock" name="prdStock">â–²â–¼</span></th>
                    <th><B>åº«å­˜æœˆä»½</B></th>
                </tr>
            </thead>
            <tbody>
                {% for data in monthData %}
                <tr id="tdTr">
                    <td>{{data.str_code.str_loc}}</td>
                    <td>{{data.str_code.str_city}}</td>
                    <td>{{data.str_code.str_code}}</td>
                    <td>{{data.str_code.str_name}}</td>
                    <td>{{data.prd_code.prd_code}}</td>
                    <td>{{data.prd_code.prd_barcode}}</td>
                    <td>{{data.prd_code.prd_name}}</td>
                    <td>{{data.sum_m_save}}</td>
                    <td>{{data.sum_m_buy}}</td>
                    <td>{{data.sum_m_return}}</td>
                    <td>{{data.sum_m_sale}}</td>
                    <td><B>{{data.sum_m_sale_ttl}}</B></td>
                    {%if data.sum_m_stock_mon == None %}
                    <td><B>-</B></td>
                    {% else %}
                    <td><B>{{data.sum_m_sale_err}}</B></td>
                    {% endif %}
                    <td>{{data.sum_m_stock}}</td>
                    {%if data.sum_m_stock_mon >= 6 %}
                    <td style="color:red">{{data.sum_m_stock_mon}}</td>
                    {% else %}
                    <td>{{data.sum_m_stock_mon}}</td>
                    {% endif %}
                </tr>
                {% endfor %}
            <tbody>
        </table>
    </div>
    <form action="/csm/upload/" method="POST" enctype="multipart/form-data">{% csrf_token %}
        <div class="input-group">
            <input type="file" class="form-control" id="fileInput" name="fileInput">
            <input type="submit" class="btn btn-success btn-lg" id="submitBtn" value="Upload File" disabled>
        </div>
    </form>
{% else %}
    <meta http-equiv="refresh" content="0; url='/users/login'" />
{% endif %}
<script>
    const monthData = "{{month}}";

    // ìˆ«ì ë°ì´í„° ì •ë ¬
    document.getElementById('prdName').addEventListener('click', function (event) {
        alert(document.getElementById('prdName').value);
        if(document.getElementById('prdName').value == 'â–²') {
            document.getElementById('prdName').value = 'â–¼';
        } else {
            document.getElementById('prdName').value = 'â–²';
        }
    });

    document.getElementById('prdSave').addEventListener('click', function (event) {
        alert('click');
    });
    document.getElementById('prdBuy').addEventListener('click', function (event) {
        alert('click');
    });
    document.getElementById('prdReturn').addEventListener('click', function (event) {
        alert('click');
    });
    document.getElementById('prdSale').addEventListener('click', function (event) {
        alert('click');
    });
    document.getElementById('prdStock').addEventListener('click', function (event) {
        alert('click');
    });



    // error message
    {% for message in messages %}
        alert("{{message}}");
    {% endfor %}
</script>
<script src="{% static 'script/csm.js' %}"></script>
{% endblock %}